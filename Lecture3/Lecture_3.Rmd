---
title: "Lecture 3 - An Introduction to Data Science (part II)"
subtitle: ""
author: " Presented by Renato Rodrigues Silva"
institute: "Federal University of Goias."
date: "(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---
class: inverse, center, middle

#Section based on

##Notes on R: A Programming Environment for Data Analysis and Graphics (W. N. Venables, D. M. Smith and the R Core Team,2004)
  
---
class: inverse, center, middle
#Simple manipulations



---

##Vectors and assignment

- The simplest data structure is the numeric vector, which
is a single entity consisting of an ordered collection of numbers. 
- To set up a vector, we procedure as follows

```{r}
x =  c(10.4, 5.6, 3.1, 6.4, 21.7)
x
```

- This is an **assignment statement** using the function `c()`

---

##Vectors and assignment

- Assignment can also be made using the function `assign()`. 

- An equivalent way of making the same assignment as previous one is with:

```{r}
assign("x", c(10.4, 5.6, 3.1, 6.4, 21.7))
x
```

---


##Recycling of Vectors in R

- R likes to operate on vectors of the same length, 

- So if it encounters two vectors of different lengths in a binary operation, 

- It merely replicates  the smaller vector until it is the same length as the longest vector, then it does the operation.

- If the recycled smaller vector has to be “chopped off” to make it the length of the longer vector, you will get a warning, but it will still return a result:

```{r}
x <- c(1,2,3)
y <- c(1,10)

x * y
```

[eriqande](https://eriqande.github.io/rep-res-web/lectures/vectorization_recycling_and_indexing.html)

Source: Eric C. Anderson
---

##We will see Recycling In Many contexts

- You gotta know it! Here are some more examples:

```{r}

x = 1:20

x * c(1,0)  # turns the even numbers to 0

```


---

##We will see Recycling In Many contexts

- You gotta know it! Here are some more examples:

```{r}

x * c(0, 0, 1) 

x < ((1:4)^2) 

1/x

```

Source: Eric C. Anderson
---
#Generating regular sequences

There are many ways to generate a sequence. For example,

```{r}
1:10
```

```{r}
10:1
```

```{r}
(1/2):5 
```

---
#Generating regular sequences

```{r}
seq(-5, 5, by=.2) 
```


```{r}
seq(length=20, from=-5, to=5)
```

---
#Generating regular sequences

```{r}

rep(1:5, times=5)
```


```{r}
rep(1:5, each=5)
```

```{r}
rep(c(1,4,3), c(2,7,6))
```


---
#Logical vectors

- As well as numerical vectors, R allows manipulation of logical quantities. 

- The elements of a logical vector can have the values TRUE, FALSE, and NA (for “not available”, see below).

- Logical vectors are generated by conditions. For example,

```{r}
1:5 > 13
```

The logical operators are $<, <=, >, >=, ==, !=$.

---
#Missing values

- In some cases the components of a vector may not be completely known.

- When an element or value is “not available” or a “missing value” in the statistical sense, a place within a vector may be reserved for it by assigning it the special value `NA`.

- In general any operation on an `NA` becomes an `NA`.

- The motivation for this rule is simply that if the specification of an operation is incomplete, the result cannot be known and hence is not available.

- The function `is.na(x)` gives a logical vector of the same size as `x` with value `TRUE` if and only if the corresponding element in `x` is `NA`.

---
#Missing values

- Note that there is a second kind of “missing” values which are produced by numerical computation, the so-called Not a Number, 'NaN', values. Examples are


```{r}
0 / 0
```

```{r}
Inf - Inf
```

---
class: inverse, center, middle
#Arrays and matrices

---
# Matrices

- Matrix is a two dimensional data structure in R programming.

- Matrix is similar to vector but additionally contains the dimension attribute.

- Further details can be found at [matrix](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/matrix)

.pull-left[
```{r}
## Example of setting row and column names
mdat <- matrix(c(1,2,3, 11,12,13), nrow = 2, ncol = 3, byrow = TRUE,
               dimnames = list(c("row1", "row2"),
                               c("C.1", "C.2", "C.3")))
mdat
```
]
.pull-right[

```{r}
mdat2 <- matrix(c(1,2,3, 11,12,13), nrow = 2, ncol = 3, byrow = FALSE,
               dimnames = list(c("row1", "row2"),
                               c("C.1", "C.2", "C.3")))

mdat2
```
]

---
#Arrays

- Arrays are the R data objects which can store data in more than two dimensions. 

- For example − If we create an array of dimension (2, 3, 4) then it creates 4 rectangular matrices each with 2 rows and 3 columns. 

- Arrays can store only data type. [array](https://www.tutorialspoint.com/r/r_arrays.htm)

- The general representation of the array is the following: 
`array(data_vector, dim_vector)`



---
#Arrays

```{r}
# Take these vectors as input to the array.
vector1 = c(5,9,3)
vector2 = c(10,11,12,13,14,15)
result = array(c(vector1,vector2),dim = c(3,3,2))

result
```

---
#Arrays

```{r}

# Print the third row of the second matrix of the array.
print(result[3,,2])

# Print the element in the 1st row and 3rd column of the 1st matrix.
print(result[1,3,1])

# Print the 2nd Matrix.
print(result[,,2])
```

---
class: inverse, center, middle
#Lists and data frames

---
#Lists

- An R list is an object consisting of an **ordered collection of objects** known as its components.

- There is no particular need for the components to be of the same mode or type. 


```{r}

Lst <- list(person="Fred", wife="Mary", no.children=3,
child.ages=c(4,7,9))

Lst

```

---
#Lists

- Components are always numbered and may always be referred to as such. 

- Thus if Lst is the name of a list with four components, these may be individually referred to as `Lst[[1]]`, `Lst[[2]]`,`Lst[[3]]` and `Lst[[4]]`.

- If, further, `Lst[[4]]` is a vector subscripted array then
`Lst[[4]][1]` is its first entry.


```{r}

Lst[[1]]

Lst[[4]] 

Lst[[4]][1]

```

---
#Lists

- Components of lists may also be named,

- And in this case the component may be referred to either by giving the component name as a character string in place of the number in double square brackets, 


```{r}

Lst$person

Lst$child.ages[2]

Lst[["child.ages"]][2]

```


---
#Data frames

A data frame is a list with class "data.frame". There are restrictions on lists that may be made into data frames, namely

- The components must be vectors (numeric, character, or logical), factors, numeric matrices, lists, or other data frames.

- Matrices, lists, and data frames provide as many variables to the new data frame as they have columns, elements, or variables, respectively.

- Numeric vectors, logicals and factors are included as is, and by default character vectors are coerced to be factors, whose levels are the unique values appearing in the vector.

- Vector structures appearing as variables of the data frame must all have the same length, and matrix structures must all have the same row size.

---

#Making data frames

```{r}

dat = data.frame(student = c("Renato", "Joao", "Pedro", "Maria", "Joana"), grades = c(10,2,4,9,9.5), approved = c(T,F,F,T,T))

dat

```

---
class: inverse, center, middle
#Reading data from files

---
#Set the Working Directory

- Before reading any data, you must set the R working directory to the location of the data.

- `setwd(“…”)` will set the current working directory to a specific location

- `getwd()` will print out the current directory.

- `> setwd("C:/mydata")` (Windows)

- When specifying the pathname, R reads forward slashes, whereas Windows reads backward slashes.  

[path](https://en.wikipedia.org/wiki/Path_(computing))

- **Setting the working directory properly can eliminate path confusion.**

Source: [SAMHDA](https://www.datafiles.samhsa.gov/faq/how-do-i-read-data-r-nid3445)

---
#Reading data from files

- Reading data into a statistical system for analysis and exporting the results to some other system for report writing can be frustrating tasks.

- Sometimes it takes far more time than the statistical analysis itself, even though most readers will find the latter far more appealing.

- The function `read.table` is the most convenient way to read in a rectangular grid of data. 

- Because of the many possibilities, there are several other functions that call `read.table` but change a group of default arguments.

- Beware that read.table is an inefficient way to read in very large numerical matrices.

---
##Reading Delimited Data Files - Space-Delimited

Function: `read.table()`

Common Parameters:

- File: the name of the file which the data are to be read from.

- Header: TRUE when first row includes variable names. The default is FALSE.

- Sep: A string indicating what is separating the data. The default is "  ".


'> dataSPACE <-read.table("C:/mydata/survey.dat", header=TRUE, sep= " ")'

or

'> dataSPACE <-read.table("C:/mydata/survey.txt", header=TRUE, sep= " ")'

---
##Reading Delimited Data Files - Tab-Delimited

Function: `read.table()`

Example:

`> dataTAB <-read.table("survey.dat", header=TRUE, sep= "\t")`

or 

`> dataTAB <-read.table("survey.txt", header=TRUE, sep= "\t")`

- Further details can be found typing `?read.table` on the RStudio console or in [manual](https://cran.r-project.org/doc/manuals/r-release/R-data.html#Variations-on-read_002etable).

- Lecture about how to represent characters in computer memories. [lecture12](https://www.youtube.com/watch?v=kW_vetzPU_I),
[utf8](https://www.youtube.com/watch?v=sqPTR_v4qFA&t=551s).

- A intersting article about enconding [kunststube](http://kunststube.net/encoding/) 

---
class: middle
##Reading comma delimited files

- `read.csv()` reads comma delimited files, 

- `read.csv2()` reads semicolon separated files (common in countries where , is used as the decimal place).

- However, we are going to use tidyverse packages to import data.

---
class: inverse, center, middle
#Tidyverse

---
#Tidyverse

- The tidyverse is a **collection of R packages** designed **for data science**. 

- All packages share an underlying design philosophy, grammar, and data structures.

Install the complete tidyverse with:

```{r, eval=FALSE}
install.packages("tidyverse")
```

- Any help ?? [tidyverse](https://www.tidyverse.org/)

---
class: inverse, center, middle

#Section based on

##R for Data Science: Written by Garrett Grolemund and Hadley Wickham

---
class: inverse, center, middle

#Data import with Tidyverse


---
class: middle
##Data import

- You’ll learn how to read plain-text rectangular files into R.

- Here, we’ll only scratch the surface of data import, but many of the principles will translate to other forms of data.

---
##Data import

Most of readr’s functions are concerned with turning flat files into data frames:

- `read_csv()` reads comma delimited files, 

- `read_csv2()` reads semicolon separated files (common in countries where , is used as the decimal place), 

- `read_tsv()` reads tab delimited files, and `read_delim()` reads in files with any delimiter.

- `read_fwf()` reads fixed width files. 

- `read_log()` reads Apache style log files.

---
##Data import

- We’ll focus on `read_csv()`. 

- The first argument to `read_csv()` is the most important: it’s the path to the file to read.

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
x = read_csv("teste.csv") 
head(x)


```

---
##Data import

- You can also supply an inline csv file. 

- This is useful for experimenting with readr and for creating reproducible examples to share with others:

```{r}
read_csv("a,b,c
1,2,3
4,5,6")
```

---
##Data import

-  Sometimes there are a few lines of metadata at the top of the file. You can use skip = n to skip the first n lines; 

```{r}
read_csv("The first line of metadata
  The second line of metadata
  x,y,z
  1,2,3", skip = 2)
```

---
##Data import

- Or use comment = "#" to drop all lines that start with (e.g.) #.

```{r}
read_csv("# A comment I want to skip
  x,y,z
  1,2,3", comment = "#")
```

---
##Data import


-  The data might not have column names. You can use` col_names = FALSE` to tell `read_csv()` not to treat the first row as headings, and instead label them sequentially from $X_1$ to $X_n$

```{r}
read_csv("1,2,3\n 4,5,6", col_names = FALSE)
```

"\n" is a convenient shortcut for adding a new line.

---
##Data import

-  Alternatively you can pass col_names a character vector which will be used as the column names:

```{r}
read_csv("1,2,3\n4,5,6", col_names = c("x", "y", "z"))
```

---
##Data import

- Another option that commonly needs tweaking is na: this specifies the value (or values) that are used to represent missing values in your file:

```{r}
read_csv("a,b,c\n1,2,.", na = ".")
```

---
##Exercise

1.  Identify what is wrong with each of the following inline CSV files. What happens when you run the code?

```{r, eval=FALSE}

read_csv("a,b\n1,2,3\n4,5,6")
read_csv("a,b,c\n1,2\n1,2,3,4")
read_csv("a,b\n\"1")
read_csv("a,b\n1,2\na,b")
read_csv("a;b\n1;3")

```

